#!/usr/bin/env python3
"""
ç¬¬åç« ï¼šæ™ºèƒ½ä½“é€šä¿¡åè®®å®Œæ•´æ•™å­¦ç¤ºä¾‹

æœ¬æ–‡ä»¶æ•´åˆäº†ç¬¬åç« ä¸­ä»‹ç»çš„ä¸‰ç§æ™ºèƒ½ä½“é€šä¿¡åè®®çš„æ‰€æœ‰å®ç”¨æ¡ˆä¾‹ï¼š

ğŸ”§ MCP (Model Context Protocol)
- å®˜æ–¹æœåŠ¡å™¨ä½¿ç”¨æ¡ˆä¾‹ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€GitHubç­‰ï¼‰
- è‡ªå®šä¹‰æœåŠ¡å™¨å¼€å‘ï¼ˆå¤©æ°”æŸ¥è¯¢æœåŠ¡å™¨ï¼‰
- å¤šç§ä¼ è¾“æ–¹å¼æ¼”ç¤ºï¼ˆStdioã€HTTPã€SSEç­‰ï¼‰
- åœ¨ HelloAgents ä¸­çš„é›†æˆä½¿ç”¨

ğŸ¤ A2A (Agent-to-Agent Protocol)
- åŸºäºå®˜æ–¹ a2a-sdk çš„æ™ºèƒ½ä½“åˆ›å»º
- å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµï¼ˆå†…å®¹åˆ›ä½œå›¢é˜Ÿï¼‰
- æ™ºèƒ½ä½“é—´æŠ€èƒ½å…±äº«å’Œè°ƒç”¨
- å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨

ğŸŒ ANP (Agent Network Protocol)
- æœåŠ¡å‘ç°å’Œæ³¨å†Œæœºåˆ¶
- ç½‘ç»œæ‹“æ‰‘ç®¡ç†å’Œç›‘æ§
- è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±
- å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œç®¡ç†

å­¦ä¹ ç›®æ ‡ï¼š
âœ… ç†è§£ä¸‰ç§åè®®çš„æ ¸å¿ƒæ¦‚å¿µå’Œè®¾è®¡ç†å¿µ
âœ… æŒæ¡æ¯ç§åè®®çš„å®é™…ä½¿ç”¨æ–¹æ³•å’Œæœ€ä½³å®è·µ
âœ… å­¦ä¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„åè®®
âœ… ä½“éªŒåè®®åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨æ•ˆæœ
âœ… äº†è§£åè®®é—´çš„ç»„åˆä½¿ç”¨æ–¹å¼

è¿è¡Œæ–¹å¼ï¼š
python examples/chapter10_protocols_complete.py

ä¾èµ–å®‰è£…ï¼š
pip install fastmcp>=2.0.0 a2a-sdk

ä½œè€…ï¼šHelloAgents æ•™å­¦å›¢é˜Ÿ
æ›´æ–°ï¼š2024å¹´12æœˆ
"""

import asyncio
import sys
import os
import json
import time
import random
from datetime import datetime, timedelta
from typing import Dict, Any, List, Optional

# æ·»åŠ é¡¹ç›®è·¯å¾„
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

def print_header(title: str):
    """æ‰“å°ç« èŠ‚æ ‡é¢˜"""
    print("\n" + "=" * 70)
    print(f"ğŸ“š {title}")
    print("=" * 70)

def print_section(title: str):
    """æ‰“å°å°èŠ‚æ ‡é¢˜"""
    print(f"\nğŸ“‹ {title}")
    print("-" * 50)

def print_lesson(lesson_num: str, title: str):
    """æ‰“å°è¯¾ç¨‹æ ‡é¢˜"""
    print(f"\nğŸ“ è¯¾ç¨‹ {lesson_num}: {title}")
    print("ğŸ”¹" * 40)

def print_demo(title: str):
    """æ‰“å°æ¼”ç¤ºæ ‡é¢˜"""
    print(f"\nğŸš€ {title}")
    print("ğŸ’¡" * 30)

def print_success(message: str):
    """æ‰“å°æˆåŠŸä¿¡æ¯"""
    print(f"âœ… {message}")

def print_info(message: str):
    """æ‰“å°ä¿¡æ¯"""
    print(f"â„¹ï¸  {message}")

def print_warning(message: str):
    """æ‰“å°è­¦å‘Š"""
    print(f"âš ï¸  {message}")

def print_error(message: str):
    """æ‰“å°é”™è¯¯"""
    print(f"âŒ {message}")

def wait_for_user(prompt: str = "æŒ‰å›è½¦é”®ç»§ç»­..."):
    """ç­‰å¾…ç”¨æˆ·è¾“å…¥"""
    input(f"\n{prompt}")

def show_course_overview():
    """æ˜¾ç¤ºè¯¾ç¨‹æ¦‚è§ˆ"""
    print_header("ç¬¬åç« ï¼šæ™ºèƒ½ä½“é€šä¿¡åè®® - è¯¾ç¨‹æ¦‚è§ˆ")
    
    overview = """
ğŸ¯ è¯¾ç¨‹ç›®æ ‡
æœ¬ç« å°†å¸¦ä½ æ·±å…¥äº†è§£æ™ºèƒ½ä½“é€šä¿¡çš„ä¸‰ç§æ ¸å¿ƒåè®®ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®é™…åº”ç”¨ï¼Œ
è®©ä½ èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­çµæ´»è¿ç”¨è¿™äº›åè®®æ„å»ºå¼ºå¤§çš„æ™ºèƒ½ä½“ç³»ç»Ÿã€‚

ğŸ“– è¯¾ç¨‹ç»“æ„

ç¬¬ä¸€éƒ¨åˆ†ï¼šMCP (Model Context Protocol)
â”œâ”€â”€ 1.1 MCP åŸºç¡€æ¦‚å¿µå’Œè®¾è®¡ç†å¿µ
â”œâ”€â”€ 1.2 ä½¿ç”¨å®˜æ–¹ MCP æœåŠ¡å™¨å®æˆ˜
â”œâ”€â”€ 1.3 åˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨
â”œâ”€â”€ 1.4 å¤šç§ä¼ è¾“æ–¹å¼è¯¦è§£
â””â”€â”€ 1.5 åœ¨ HelloAgents ä¸­é›†æˆ MCP

ç¬¬äºŒéƒ¨åˆ†ï¼šA2A (Agent-to-Agent Protocol)  
â”œâ”€â”€ 2.1 A2A åè®®æ ¸å¿ƒæ¦‚å¿µ
â”œâ”€â”€ 2.2 åŸºäºå®˜æ–¹ SDK åˆ›å»ºæ™ºèƒ½ä½“
â”œâ”€â”€ 2.3 å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ
â”œâ”€â”€ 2.4 æ™ºèƒ½ä½“æŠ€èƒ½å…±äº«æœºåˆ¶
â””â”€â”€ 2.5 å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨

ç¬¬ä¸‰éƒ¨åˆ†ï¼šANP (Agent Network Protocol)
â”œâ”€â”€ 3.1 ANP ç½‘ç»œç®¡ç†æ¦‚å¿µ
â”œâ”€â”€ 3.2 æœåŠ¡å‘ç°å’Œæ³¨å†Œ
â”œâ”€â”€ 3.3 ç½‘ç»œæ‹“æ‰‘å’Œç›‘æ§
â”œâ”€â”€ 3.4 è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±
â””â”€â”€ 3.5 å¤§è§„æ¨¡ç½‘ç»œç®¡ç†

ç¬¬å››éƒ¨åˆ†ï¼šåè®®å¯¹æ¯”å’Œé€‰æ‹©
â”œâ”€â”€ 4.1 ä¸‰ç§åè®®ç‰¹æ€§å¯¹æ¯”
â”œâ”€â”€ 4.2 åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—
â”œâ”€â”€ 4.3 åè®®ç»„åˆä½¿ç”¨ç­–ç•¥
â””â”€â”€ 4.4 æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹

ğŸ› ï¸ å®è·µé¡¹ç›®
- å¤©æ°”æŸ¥è¯¢ MCP æœåŠ¡å™¨
- å†…å®¹åˆ›ä½œ A2A å›¢é˜Ÿ
- æ™ºèƒ½ä½“ç½‘ç»œç®¡ç†ç³»ç»Ÿ
- å¤šåè®®é›†æˆåº”ç”¨

ğŸ’¡ å­¦ä¹ å»ºè®®
1. æŒ‰é¡ºåºå­¦ä¹ ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å‰ç½®çŸ¥è¯†ä¾èµ–
2. åŠ¨æ‰‹å®è·µæ¯ä¸ªç¤ºä¾‹ï¼Œç†è§£åè®®çš„å®é™…æ•ˆæœ
3. æ€è€ƒåœ¨è‡ªå·±é¡¹ç›®ä¸­å¦‚ä½•åº”ç”¨è¿™äº›åè®®
4. å°è¯•ä¿®æ”¹ç¤ºä¾‹ä»£ç ï¼Œæ¢ç´¢æ›´å¤šå¯èƒ½æ€§
"""
    
    print(overview)
    wait_for_user("å‡†å¤‡å¥½å¼€å§‹å­¦ä¹ äº†å—ï¼Ÿ")

def check_dependencies():
    """æ£€æŸ¥ä¾èµ–å®‰è£…æƒ…å†µ"""
    print_section("ç¯å¢ƒæ£€æŸ¥")
    
    dependencies = {
        "fastmcp": "FastMCP åº“ï¼ˆMCP åè®®æ”¯æŒï¼‰",
        "a2a": "A2A SDKï¼ˆA2A åè®®æ”¯æŒï¼‰"
    }
    
    missing_deps = []
    
    for dep, desc in dependencies.items():
        try:
            if dep == "fastmcp":
                import fastmcp
                print_success(f"{desc} - ç‰ˆæœ¬ {fastmcp.__version__}")
            elif dep == "a2a":
                from a2a.client import A2AClient
                print_success(f"{desc} - å·²å®‰è£…")
        except ImportError:
            print_warning(f"{desc} - æœªå®‰è£…")
            missing_deps.append(dep)
    
    if missing_deps:
        print_info("å®‰è£…ç¼ºå¤±çš„ä¾èµ–ï¼š")
        for dep in missing_deps:
            if dep == "fastmcp":
                print(f"  pip install fastmcp>=2.0.0")
            elif dep == "a2a":
                print(f"  pip install a2a-sdk")
        
        choice = input("\næ˜¯å¦ç»§ç»­ï¼ˆæŸäº›åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ï¼‰ï¼Ÿ(y/n): ").lower()
        if choice != 'y':
            print("é€€å‡ºç¨‹åºã€‚è¯·å®‰è£…ä¾èµ–åé‡æ–°è¿è¡Œã€‚")
            sys.exit(1)
    else:
        print_success("æ‰€æœ‰ä¾èµ–å·²æ­£ç¡®å®‰è£…ï¼")
    
    wait_for_user()

# ============================================================================
# ç¬¬ä¸€éƒ¨åˆ†ï¼šMCP åè®®æ•™å­¦
# ============================================================================

def lesson_1_1_mcp_concepts():
    """è¯¾ç¨‹ 1.1: MCP åŸºç¡€æ¦‚å¿µ"""
    print_lesson("1.1", "MCP åŸºç¡€æ¦‚å¿µå’Œè®¾è®¡ç†å¿µ")
    
    concepts = """
ğŸ“š ä»€ä¹ˆæ˜¯ MCPï¼Ÿ
MCP (Model Context Protocol) æ˜¯ç”± Anthropic å¼€å‘çš„å¼€æ”¾æ ‡å‡†ï¼Œç”¨äºåœ¨ AI åº”ç”¨ç¨‹åº
å’Œå¤–éƒ¨æ•°æ®æºä¹‹é—´å»ºç«‹å®‰å…¨ã€å¯æ§çš„è¿æ¥ã€‚

ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼š
1. å·¥å…· (Tools): AI å¯ä»¥è°ƒç”¨çš„å‡½æ•°ï¼Œç±»ä¼¼äº API ç«¯ç‚¹
2. èµ„æº (Resources): å¯ä»¥è®¿é—®çš„æ•°æ®æºï¼Œå¦‚æ–‡ä»¶ã€æ•°æ®åº“è®°å½•
3. æç¤ºè¯ (Prompts): é¢„å®šä¹‰çš„æç¤ºè¯æ¨¡æ¿
4. ä¼ è¾“å±‚ (Transport): é€šä¿¡æ–¹å¼ï¼Œæ”¯æŒ Stdioã€HTTPã€WebSocket ç­‰

ğŸ’¡ è®¾è®¡ç†å¿µï¼š
- æ ‡å‡†åŒ–ï¼šç»Ÿä¸€çš„åè®®è§„èŒƒï¼Œç¡®ä¿å…¼å®¹æ€§
- å®‰å…¨æ€§ï¼šå¯æ§çš„è®¿é—®æƒé™å’Œæ•°æ®éš”ç¦»
- çµæ´»æ€§ï¼šæ”¯æŒå¤šç§ä¼ è¾“æ–¹å¼å’Œæ•°æ®æ ¼å¼
- å¯æ‰©å±•æ€§ï¼šæ˜“äºæ·»åŠ æ–°çš„å·¥å…·å’Œèµ„æº

ğŸ”§ åœ¨ HelloAgents ä¸­çš„å®ç°ï¼š
HelloAgents åŸºäº FastMCP åº“æä¾›å®Œæ•´çš„ MCP åè®®æ”¯æŒï¼ŒåŒ…æ‹¬ï¼š
- æœåŠ¡å™¨ç«¯ï¼šåˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨
- å®¢æˆ·ç«¯ï¼šè¿æ¥å’Œä½¿ç”¨ MCP æœåŠ¡å™¨
- å·¥å…·é›†æˆï¼šåœ¨ Agent ä¸­ä½¿ç”¨ MCP å·¥å…·
- å¤šä¼ è¾“æ”¯æŒï¼šStdioã€HTTPã€SSE ç­‰ä¼ è¾“æ–¹å¼
"""
    
    print(concepts)
    wait_for_user()

def lesson_1_2_official_mcp_servers():
    """è¯¾ç¨‹ 1.2: ä½¿ç”¨å®˜æ–¹ MCP æœåŠ¡å™¨"""
    print_lesson("1.2", "ä½¿ç”¨å®˜æ–¹ MCP æœåŠ¡å™¨å®æˆ˜")
    
    print_info("å®˜æ–¹ MCP æœåŠ¡å™¨æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬æ¥ä½“éªŒä¸€ä¸‹ï¼š")
    
    # æ¨¡æ‹Ÿå®˜æ–¹æœåŠ¡å™¨ä½¿ç”¨
    official_servers = {
        "filesystem": {
            "description": "æ–‡ä»¶ç³»ç»Ÿæ“ä½œæœåŠ¡å™¨",
            "tools": ["list_directory", "read_file", "write_file"],
            "install": "npx @modelcontextprotocol/server-filesystem"
        },
        "github": {
            "description": "GitHub ä»“åº“è®¿é—®æœåŠ¡å™¨", 
            "tools": ["search_repositories", "get_repository", "list_issues"],
            "install": "npx @modelcontextprotocol/server-github"
        },
        "memory": {
            "description": "å†…å­˜å­˜å‚¨æœåŠ¡å™¨",
            "tools": ["store_memory", "retrieve_memory", "list_memories"],
            "install": "npx @modelcontextprotocol/server-memory"
        }
    }
    
    print("\nğŸ—‚ï¸ å®˜æ–¹ MCP æœåŠ¡å™¨åˆ—è¡¨ï¼š")
    for name, info in official_servers.items():
        print(f"\nğŸ“¦ {name.upper()} æœåŠ¡å™¨")
        print(f"   æè¿°: {info['description']}")
        print(f"   å·¥å…·: {', '.join(info['tools'])}")
        print(f"   å®‰è£…: {info['install']}")
    
    print_demo("æ–‡ä»¶ç³»ç»ŸæœåŠ¡å™¨æ¼”ç¤º")
    
    # æ¨¡æ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ“ä½œ
    demo_operations = [
        ("åˆ—å‡ºå½“å‰ç›®å½•", "æ‰¾åˆ° 15 ä¸ªæ–‡ä»¶"),
        ("è¯»å– README.md", "æˆåŠŸè¯»å– 1,234 å­—ç¬¦"),
        ("åˆ›å»ºæµ‹è¯•æ–‡ä»¶", "æˆåŠŸåˆ›å»º test.txt"),
        ("éªŒè¯æ–‡ä»¶åˆ›å»º", "æ–‡ä»¶å­˜åœ¨ï¼Œå¤§å° 56 å­—èŠ‚")
    ]
    
    for operation, result in demo_operations:
        print(f"ğŸ”§ {operation}...")
        time.sleep(0.5)
        print_success(result)
    
    wait_for_user()

def lesson_1_3_custom_mcp_server():
    """è¯¾ç¨‹ 1.3: åˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨"""
    print_lesson("1.3", "åˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨")
    
    print_info("è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤©æ°”æŸ¥è¯¢ MCP æœåŠ¡å™¨ä½œä¸ºå­¦ä¹ æ¡ˆä¾‹ï¼š")
    
    # å±•ç¤ºæœåŠ¡å™¨ä»£ç ç»“æ„
    server_code = '''
from fastmcp import FastMCP
from typing import Dict, Any

# åˆ›å»ºæœåŠ¡å™¨å®ä¾‹
weather_server = FastMCP("weather-server")

@weather_server.tool()
def get_weather(city: str) -> Dict[str, Any]:
    """è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"""
    # æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
    weather_data = {
        "city": city,
        "temperature": 22,
        "humidity": 65,
        "condition": "æ™´æœ—",
        "query_time": "2024-12-05 14:30:00"
    }
    return weather_data

@weather_server.tool()
def get_weather_forecast(city: str, days: int = 3) -> Dict[str, Any]:
    """è·å–å¤©æ°”é¢„æŠ¥"""
    forecast = []
    for i in range(days):
        forecast.append({
            "date": f"2024-12-{6+i:02d}",
            "temperature_high": 25 + i,
            "temperature_low": 15 + i,
            "condition": "å¤šäº‘"
        })
    
    return {
        "city": city,
        "forecast": forecast
    }

if __name__ == "__main__":
    weather_server.run()
'''
    
    print("\nğŸ’» å¤©æ°”æœåŠ¡å™¨ä»£ç ç¤ºä¾‹ï¼š")
    print("```python")
    print(server_code)
    print("```")
    
    print_demo("å¤©æ°”æœåŠ¡å™¨åŠŸèƒ½æ¼”ç¤º")
    
    # æ¨¡æ‹ŸæœåŠ¡å™¨åŠŸèƒ½
    demo_calls = [
        ("get_weather", {"city": "åŒ—äº¬"}, {"city": "åŒ—äº¬", "temperature": 15, "condition": "æ™´æœ—"}),
        ("get_weather_forecast", {"city": "ä¸Šæµ·", "days": 3}, {"city": "ä¸Šæµ·", "forecast_days": 3}),
        ("list_cities", {}, {"supported_cities": ["åŒ—äº¬", "ä¸Šæµ·", "å¹¿å·"], "total_count": 10})
    ]
    
    for tool_name, args, result in demo_calls:
        print(f"\nğŸ”§ è°ƒç”¨å·¥å…·: {tool_name}")
        print(f"   å‚æ•°: {args}")
        time.sleep(0.3)
        print_success(f"è¿”å›: {result}")
    
    wait_for_user()

def lesson_1_4_transport_methods():
    """è¯¾ç¨‹ 1.4: å¤šç§ä¼ è¾“æ–¹å¼è¯¦è§£"""
    print_lesson("1.4", "MCP ä¼ è¾“æ–¹å¼è¯¦è§£")
    
    transport_info = """
ğŸš€ MCP æ”¯æŒå¤šç§ä¼ è¾“æ–¹å¼ï¼Œé€‚åº”ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼š

1ï¸âƒ£ Stdio ä¼ è¾“ï¼ˆé»˜è®¤ï¼‰
   - é€šè¿‡æ ‡å‡†è¾“å…¥è¾“å‡ºé€šä¿¡
   - é€‚ç”¨äºæœ¬åœ°è¿›ç¨‹
   - ä½¿ç”¨åœºæ™¯ï¼šå¼€å‘æµ‹è¯•ã€æœ¬åœ°å·¥å…·é›†æˆ
   
   å®¢æˆ·ç«¯è¿æ¥ï¼š
   client = MCPClient("weather_server.py")

2ï¸âƒ£ HTTP ä¼ è¾“
   - é€šè¿‡ HTTP åè®®é€šä¿¡
   - é€‚ç”¨äºè¿œç¨‹æœåŠ¡
   - ä½¿ç”¨åœºæ™¯ï¼šWeb æœåŠ¡ã€API é›†æˆ
   
   æœåŠ¡å™¨å¯åŠ¨ï¼š
   server.run(transport="http", host="0.0.0.0", port=8000)
   
   å®¢æˆ·ç«¯è¿æ¥ï¼š
   client = MCPClient("http://localhost:8000")

3ï¸âƒ£ SSE ä¼ è¾“
   - é€šè¿‡ Server-Sent Events å®æ—¶é€šä¿¡
   - é€‚ç”¨äºéœ€è¦å®æ—¶æ›´æ–°çš„åœºæ™¯
   - ä½¿ç”¨åœºæ™¯ï¼šå®æ—¶ç›‘æ§ã€æµå¼æ•°æ®
   
   å®¢æˆ·ç«¯è¿æ¥ï¼š
   client = MCPClient("http://localhost:8000", transport_type="sse")

4ï¸âƒ£ å†…å­˜ä¼ è¾“
   - ç›´æ¥åœ¨å†…å­˜ä¸­é€šä¿¡
   - é€‚ç”¨äºæµ‹è¯•å’Œå¼€å‘
   - ä½¿ç”¨åœºæ™¯ï¼šå•å…ƒæµ‹è¯•ã€å¿«é€ŸåŸå‹
   
   å®¢æˆ·ç«¯è¿æ¥ï¼š
   server_instance = FastMCP("memory-server")
   client = MCPClient(server_instance)

ğŸ’¡ ä¼ è¾“æ–¹å¼é€‰æ‹©å»ºè®®ï¼š
- å¼€å‘é˜¶æ®µï¼šä½¿ç”¨ Stdio æˆ–å†…å­˜ä¼ è¾“
- ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ HTTP ä¼ è¾“
- å®æ—¶åº”ç”¨ï¼šä½¿ç”¨ SSE ä¼ è¾“
- æµ‹è¯•åœºæ™¯ï¼šä½¿ç”¨å†…å­˜ä¼ è¾“
"""
    
    print(transport_info)
    wait_for_user()

def lesson_1_5_mcp_in_helloagents():
    """è¯¾ç¨‹ 1.5: åœ¨ HelloAgents ä¸­é›†æˆ MCP"""
    print_lesson("1.5", "åœ¨ HelloAgents ä¸­é›†æˆ MCP")
    
    integration_code = '''
from hello_agents import SimpleAgent, HelloAgentsLLM
from hello_agents.tools.builtin.protocol_tools import MCPTool

# åˆ›å»ºæ™ºèƒ½ä½“
llm = HelloAgentsLLM()
agent = SimpleAgent(name="å¤©æ°”åŠ©æ‰‹", llm=llm)

# æ·»åŠ  MCP å·¥å…·
weather_tool = MCPTool(
    server_command=["python", "weather_server.py"],
    name="å¤©æ°”æŸ¥è¯¢å·¥å…·"
)
agent.add_tool(weather_tool)

# ä½¿ç”¨æ™ºèƒ½ä½“
response = agent.run("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")
print(response)
'''
    
    print_info("HelloAgents æä¾›äº† MCPTool æ¥è½»æ¾é›†æˆ MCP æœåŠ¡å™¨ï¼š")
    print("\nğŸ’» é›†æˆä»£ç ç¤ºä¾‹ï¼š")
    print("```python")
    print(integration_code)
    print("```")
    
    print_demo("æ™ºèƒ½ä½“ä½¿ç”¨ MCP å·¥å…·æ¼”ç¤º")
    
    # æ¨¡æ‹Ÿæ™ºèƒ½ä½“å¯¹è¯
    conversations = [
        ("ç”¨æˆ·", "åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"),
        ("åŠ©æ‰‹", "æˆ‘æ¥ä¸ºæ‚¨æŸ¥è¯¢åŒ—äº¬çš„å¤©æ°”ä¿¡æ¯..."),
        ("ç³»ç»Ÿ", "è°ƒç”¨ MCP å·¥å…·: get_weather(city='åŒ—äº¬')"),
        ("åŠ©æ‰‹", "æ ¹æ®æŸ¥è¯¢ç»“æœï¼ŒåŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦15Â°Cï¼Œæ¹¿åº¦60%ã€‚")
    ]
    
    for speaker, message in conversations:
        if speaker == "ç”¨æˆ·":
            print(f"\nğŸ‘¤ {speaker}: {message}")
        elif speaker == "åŠ©æ‰‹":
            print(f"ğŸ¤– {speaker}: {message}")
        else:
            print(f"âš™ï¸  {speaker}: {message}")
        time.sleep(0.8)
    
    wait_for_user()

# ============================================================================
# ç¬¬äºŒéƒ¨åˆ†ï¼šA2A åè®®æ•™å­¦
# ============================================================================

def lesson_2_1_a2a_concepts():
    """è¯¾ç¨‹ 2.1: A2A åè®®æ ¸å¿ƒæ¦‚å¿µ"""
    print_lesson("2.1", "A2A åè®®æ ¸å¿ƒæ¦‚å¿µ")
    
    concepts = """
ğŸ¤ ä»€ä¹ˆæ˜¯ A2Aï¼Ÿ
A2A (Agent-to-Agent Protocol) æ˜¯ä¸€ä¸ªç”¨äºæ™ºèƒ½ä½“é—´ç›´æ¥é€šä¿¡å’Œåä½œçš„åè®®ã€‚
å®ƒå…è®¸å¤šä¸ªæ™ºèƒ½ä½“ç›¸äº’å‘ç°ã€é€šä¿¡ï¼Œå¹¶åä½œå®Œæˆå¤æ‚ä»»åŠ¡ã€‚

ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼š
1. æ™ºèƒ½ä½“ (Agent): å…·æœ‰ç‰¹å®šæŠ€èƒ½çš„ç‹¬ç«‹å®ä½“
2. æŠ€èƒ½ (Skill): æ™ºèƒ½ä½“å¯ä»¥æ‰§è¡Œçš„åŠŸèƒ½
3. æ¶ˆæ¯ (Message): æ™ºèƒ½ä½“é—´çš„é€šä¿¡è½½ä½“
4. åä½œ (Collaboration): å¤šä¸ªæ™ºèƒ½ä½“å…±åŒå®Œæˆä»»åŠ¡

ğŸ’¡ è®¾è®¡ç†å¿µï¼š
- å»ä¸­å¿ƒåŒ–ï¼šæ™ºèƒ½ä½“é—´ç›´æ¥é€šä¿¡ï¼Œæ— éœ€ä¸­å¤®åè°ƒå™¨
- æŠ€èƒ½å…±äº«ï¼šæ™ºèƒ½ä½“å¯ä»¥è°ƒç”¨å…¶ä»–æ™ºèƒ½ä½“çš„æŠ€èƒ½
- åŠ¨æ€å‘ç°ï¼šæ™ºèƒ½ä½“å¯ä»¥åŠ¨æ€å‘ç°å’Œè¿æ¥å…¶ä»–æ™ºèƒ½ä½“
- åä½œå·¥ä½œæµï¼šæ”¯æŒå¤æ‚çš„å¤šæ­¥éª¤åä½œæµç¨‹

ğŸ”§ åœ¨ HelloAgents ä¸­çš„å®ç°ï¼š
HelloAgents åŸºäºå®˜æ–¹ a2a-sdk æä¾› A2A åè®®æ”¯æŒï¼š
- æ™ºèƒ½ä½“åˆ›å»ºï¼šä½¿ç”¨ A2AServer åˆ›å»ºæ™ºèƒ½ä½“
- æŠ€èƒ½å®šä¹‰ï¼šä½¿ç”¨è£…é¥°å™¨å®šä¹‰æ™ºèƒ½ä½“æŠ€èƒ½
- æ¶ˆæ¯é€šä¿¡ï¼šæ”¯æŒç»“æ„åŒ–æ¶ˆæ¯ä¼ é€’
- å·¥ä½œæµç¼–æ’ï¼šæ”¯æŒå¤æ‚çš„åä½œæµç¨‹
"""
    
    print(concepts)
    wait_for_user()

def lesson_2_2_create_a2a_agents():
    """è¯¾ç¨‹ 2.2: åŸºäºå®˜æ–¹ SDK åˆ›å»ºæ™ºèƒ½ä½“"""
    print_lesson("2.2", "åŸºäºå®˜æ–¹ SDK åˆ›å»ºæ™ºèƒ½ä½“")
    
    agent_code = '''
from hello_agents.protocols.a2a.implementation import A2AServer

# åˆ›å»ºæ™ºèƒ½ä½“
calculator = A2AServer(
    name="calculator-agent",
    description="ä¸“ä¸šçš„æ•°å­¦è®¡ç®—æ™ºèƒ½ä½“",
    capabilities={"math": ["add", "multiply", "divide"]}
)

@calculator.skill("add")
def add_numbers(query: str) -> str:
    """åŠ æ³•è®¡ç®—"""
    # è§£ææŸ¥è¯¢å¹¶æ‰§è¡Œè®¡ç®—
    if "+" in query:
        parts = query.split("+")
        numbers = [float(x.strip()) for x in parts]
        result = sum(numbers)
        return f"è®¡ç®—ç»“æœ: {' + '.join(map(str, numbers))} = {result}"
    return "è¯·ä½¿ç”¨æ ¼å¼: 5 + 3"

@calculator.skill("multiply")
def multiply_numbers(query: str) -> str:
    """ä¹˜æ³•è®¡ç®—"""
    if "*" in query:
        parts = query.split("*")
        numbers = [float(x.strip()) for x in parts]
        result = 1
        for num in numbers:
            result *= num
        return f"è®¡ç®—ç»“æœ: {' Ã— '.join(map(str, numbers))} = {result}"
    return "è¯·ä½¿ç”¨æ ¼å¼: 5 * 3"

# æµ‹è¯•æ™ºèƒ½ä½“æŠ€èƒ½
print("æµ‹è¯•è®¡ç®—å™¨æ™ºèƒ½ä½“:")
print(calculator.skills["add"]("10 + 5"))
print(calculator.skills["multiply"]("6 * 7"))
'''
    
    print_info("è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè®¡ç®—å™¨æ™ºèƒ½ä½“ä½œä¸ºå­¦ä¹ æ¡ˆä¾‹ï¼š")
    print("\nğŸ’» æ™ºèƒ½ä½“åˆ›å»ºä»£ç ï¼š")
    print("```python")
    print(agent_code)
    print("```")
    
    print_demo("è®¡ç®—å™¨æ™ºèƒ½ä½“æ¼”ç¤º")
    
    # æ¨¡æ‹Ÿæ™ºèƒ½ä½“æŠ€èƒ½æµ‹è¯•
    test_cases = [
        ("add", "10 + 5", "è®¡ç®—ç»“æœ: 10 + 5 = 15"),
        ("multiply", "6 * 7", "è®¡ç®—ç»“æœ: 6 Ã— 7 = 42"),
        ("add", "1 + 2 + 3", "è®¡ç®—ç»“æœ: 1 + 2 + 3 = 6")
    ]
    
    for skill, query, expected in test_cases:
        print(f"\nğŸ”§ æŠ€èƒ½: {skill}")
        print(f"   æŸ¥è¯¢: {query}")
        time.sleep(0.3)
        print_success(f"ç»“æœ: {expected}")
    
    wait_for_user()

def lesson_2_3_multi_agent_collaboration():
    """è¯¾ç¨‹ 2.3: å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ"""
    print_lesson("2.3", "å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ")

    print_info("è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå†…å®¹åˆ›ä½œå›¢é˜Ÿï¼Œå±•ç¤ºå¤šæ™ºèƒ½ä½“åä½œï¼š")

    workflow_description = """
ğŸ“ å†…å®¹åˆ›ä½œå›¢é˜Ÿå·¥ä½œæµï¼š

1ï¸âƒ£ ç ”ç©¶å‘˜æ™ºèƒ½ä½“ (Researcher)
   - è´Ÿè´£ä¸»é¢˜ç ”ç©¶å’Œæ•°æ®æ”¶é›†
   - æŠ€èƒ½ï¼šresearch_topic, fact_check
   - è¾“å‡ºï¼šç»“æ„åŒ–çš„ç ”ç©¶æŠ¥å‘Š

2ï¸âƒ£ æ’°å†™å‘˜æ™ºèƒ½ä½“ (Writer)
   - åŸºäºç ”ç©¶æ•°æ®åˆ›ä½œæ–‡ç« 
   - æŠ€èƒ½ï¼šwrite_article, create_summary
   - è¾“å‡ºï¼šé«˜è´¨é‡çš„æ–‡ç« å†…å®¹

3ï¸âƒ£ ç¼–è¾‘æ™ºèƒ½ä½“ (Editor)
   - å†…å®¹ä¼˜åŒ–å’Œè´¨é‡æ§åˆ¶
   - æŠ€èƒ½ï¼šedit_content, final_review
   - è¾“å‡ºï¼šç»è¿‡ä¼˜åŒ–çš„æœ€ç»ˆå†…å®¹

ğŸ”„ åä½œæµç¨‹ï¼š
ç ”ç©¶å‘˜ â†’ æ’°å†™å‘˜ â†’ ç¼–è¾‘ â†’ æœ€ç»ˆå†…å®¹
"""

    print(workflow_description)

    print_demo("å†…å®¹åˆ›ä½œå›¢é˜Ÿåä½œæ¼”ç¤º")

    # æ¨¡æ‹Ÿåä½œæµç¨‹
    workflow_steps = [
        ("ç ”ç©¶å‘˜", "å¼€å§‹ç ”ç©¶ä¸»é¢˜ï¼šäººå·¥æ™ºèƒ½åœ¨æ•™è‚²ä¸­çš„åº”ç”¨", "ç”Ÿæˆç ”ç©¶æŠ¥å‘Šï¼ˆ4ä¸ªå…³é”®å‘ç°ï¼‰"),
        ("æ’°å†™å‘˜", "åŸºäºç ”ç©¶æŠ¥å‘Šåˆ›ä½œæ–‡ç« ", "å®Œæˆæ–‡ç« åˆç¨¿ï¼ˆ1,500å­—ï¼‰"),
        ("ç¼–è¾‘", "ä¼˜åŒ–æ–‡ç« å†…å®¹å’Œç»“æ„", "å®Œæˆå†…å®¹ç¼–è¾‘ï¼ˆè´¨é‡è¯„åˆ†ï¼š89/100ï¼‰"),
        ("ç¼–è¾‘", "è¿›è¡Œæœ€ç»ˆå®¡æ ¸", "æ‰¹å‡†å‘å¸ƒï¼ˆçŠ¶æ€ï¼šå·²é€šè¿‡ï¼‰")
    ]

    for agent, action, result in workflow_steps:
        print(f"\nğŸ‘¤ {agent}: {action}")
        time.sleep(0.8)
        print_success(result)

    print_info("\nğŸ‰ åä½œå®Œæˆï¼å›¢é˜ŸæˆåŠŸåˆ›ä½œäº†ä¸€ç¯‡é«˜è´¨é‡çš„æ–‡ç« ã€‚")
    wait_for_user()

def lesson_2_4_skill_sharing():
    """è¯¾ç¨‹ 2.4: æ™ºèƒ½ä½“æŠ€èƒ½å…±äº«æœºåˆ¶"""
    print_lesson("2.4", "æ™ºèƒ½ä½“æŠ€èƒ½å…±äº«æœºåˆ¶")

    sharing_concept = """
ğŸ”— æŠ€èƒ½å…±äº«æœºåˆ¶ï¼š

A2A åè®®å…è®¸æ™ºèƒ½ä½“ä¹‹é—´å…±äº«å’Œè°ƒç”¨å½¼æ­¤çš„æŠ€èƒ½ï¼Œå®ç°èƒ½åŠ›çš„ç»„åˆå’Œæ‰©å±•ã€‚

ğŸ’¡ å…±äº«æ–¹å¼ï¼š
1. ç›´æ¥è°ƒç”¨ï¼šæ™ºèƒ½ä½“Aç›´æ¥è°ƒç”¨æ™ºèƒ½ä½“Bçš„æŠ€èƒ½
2. æŠ€èƒ½å‘ç°ï¼šæ™ºèƒ½ä½“å¯ä»¥æŸ¥è¯¢å…¶ä»–æ™ºèƒ½ä½“çš„å¯ç”¨æŠ€èƒ½
3. èƒ½åŠ›ç»„åˆï¼šå¤šä¸ªæ™ºèƒ½ä½“çš„æŠ€èƒ½ç»„åˆå®Œæˆå¤æ‚ä»»åŠ¡
4. åŠ¨æ€åä½œï¼šæ ¹æ®ä»»åŠ¡éœ€æ±‚åŠ¨æ€é€‰æ‹©åˆé€‚çš„æ™ºèƒ½ä½“

ğŸ¯ åº”ç”¨åœºæ™¯ï¼š
- ä¸“ä¸šåˆ†å·¥ï¼šä¸åŒæ™ºèƒ½ä½“è´Ÿè´£ä¸åŒä¸“ä¸šé¢†åŸŸ
- èƒ½åŠ›äº’è¡¥ï¼šå¼¥è¡¥å•ä¸ªæ™ºèƒ½ä½“çš„èƒ½åŠ›ä¸è¶³
- è´Ÿè½½åˆ†æ‹…ï¼šå°†å¤æ‚ä»»åŠ¡åˆ†è§£ç»™å¤šä¸ªæ™ºèƒ½ä½“
- çŸ¥è¯†å…±äº«ï¼šå…±äº«ä¸“ä¸šçŸ¥è¯†å’Œç»éªŒ
"""

    print(sharing_concept)

    print_demo("æŠ€èƒ½å…±äº«æ¼”ç¤º")

    # æ¨¡æ‹ŸæŠ€èƒ½å…±äº«åœºæ™¯
    sharing_scenario = [
        ("ç¿»è¯‘æ™ºèƒ½ä½“", "æä¾›å¤šè¯­è¨€ç¿»è¯‘æŠ€èƒ½", "æ”¯æŒä¸­è‹±æ—¥éŸ©ç­‰10ç§è¯­è¨€"),
        ("åˆ†ææ™ºèƒ½ä½“", "è°ƒç”¨ç¿»è¯‘æŠ€èƒ½å¤„ç†å¤šè¯­è¨€æ•°æ®", "æˆåŠŸåˆ†æ5ç§è¯­è¨€çš„æ–‡æ¡£"),
        ("æŠ¥å‘Šæ™ºèƒ½ä½“", "è°ƒç”¨åˆ†æå’Œç¿»è¯‘æŠ€èƒ½", "ç”Ÿæˆå¤šè¯­è¨€åˆ†ææŠ¥å‘Š"),
        ("åè°ƒæ™ºèƒ½ä½“", "æ•´åˆæ‰€æœ‰æ™ºèƒ½ä½“çš„è¾“å‡º", "å®Œæˆç»¼åˆæ€§å¤šè¯­è¨€é¡¹ç›®")
    ]

    for agent, action, result in sharing_scenario:
        print(f"\nğŸ¤– {agent}: {action}")
        time.sleep(0.6)
        print_success(result)

    wait_for_user()

def lesson_2_5_business_scenarios():
    """è¯¾ç¨‹ 2.5: å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨"""
    print_lesson("2.5", "A2A åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­çš„åº”ç”¨")

    business_scenarios = """
ğŸ¢ å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨ï¼š

1ï¸âƒ£ å®¢æœç³»ç»Ÿ
   æ™ºèƒ½ä½“è§’è‰²ï¼šæ¥å¾…å‘˜ã€ä¸“å®¶ã€ä¸»ç®¡
   åä½œæ–¹å¼ï¼šé—®é¢˜åˆ†æµã€ä¸“ä¸šè§£ç­”ã€å‡çº§å¤„ç†

2ï¸âƒ£ ä»£ç å®¡æŸ¥
   æ™ºèƒ½ä½“è§’è‰²ï¼šå¼€å‘è€…ã€å®¡æŸ¥å‘˜ã€æµ‹è¯•å‘˜
   åä½œæ–¹å¼ï¼šä»£ç æäº¤ã€è´¨é‡æ£€æŸ¥ã€æµ‹è¯•éªŒè¯

3ï¸âƒ£ å†…å®¹åˆ›ä½œ
   æ™ºèƒ½ä½“è§’è‰²ï¼šç ”ç©¶å‘˜ã€æ’°å†™å‘˜ã€ç¼–è¾‘
   åä½œæ–¹å¼ï¼šç ”ç©¶â†’æ’°å†™â†’ç¼–è¾‘â†’å‘å¸ƒ

4ï¸âƒ£ æ•°æ®åˆ†æ
   æ™ºèƒ½ä½“è§’è‰²ï¼šæ”¶é›†å‘˜ã€åˆ†æå¸ˆã€æŠ¥å‘Šå‘˜
   åä½œæ–¹å¼ï¼šæ•°æ®æ”¶é›†â†’åˆ†æå¤„ç†â†’æŠ¥å‘Šç”Ÿæˆ

5ï¸âƒ£ æ•™å­¦ç³»ç»Ÿ
   æ™ºèƒ½ä½“è§’è‰²ï¼šè®²å¸ˆã€åŠ©æ•™ã€è¯„ä¼°å‘˜
   åä½œæ–¹å¼ï¼šè¯¾ç¨‹è®¾è®¡â†’æ•™å­¦è¾…å¯¼â†’å­¦ä¹ è¯„ä¼°

ğŸ’¼ å•†ä¸šä»·å€¼ï¼š
- æé«˜æ•ˆç‡ï¼šè‡ªåŠ¨åŒ–å¤æ‚çš„å¤šæ­¥éª¤æµç¨‹
- ä¿è¯è´¨é‡ï¼šå¤šé‡æ£€æŸ¥å’Œä¸“ä¸šåˆ†å·¥
- é™ä½æˆæœ¬ï¼šå‡å°‘äººå·¥å¹²é¢„å’Œé”™è¯¯
- å¢å¼ºçµæ´»æ€§ï¼šåŠ¨æ€è°ƒæ•´å·¥ä½œæµç¨‹
"""

    print(business_scenarios)
    wait_for_user()

# ============================================================================
# ç¬¬ä¸‰éƒ¨åˆ†ï¼šANP åè®®æ•™å­¦
# ============================================================================

def lesson_3_1_anp_concepts():
    """è¯¾ç¨‹ 3.1: ANP ç½‘ç»œç®¡ç†æ¦‚å¿µ"""
    print_lesson("3.1", "ANP ç½‘ç»œç®¡ç†æ¦‚å¿µ")

    concepts = """
ğŸŒ ä»€ä¹ˆæ˜¯ ANPï¼Ÿ
ANP (Agent Network Protocol) æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œçš„åè®®ã€‚
å®ƒæä¾›æœåŠ¡å‘ç°ã€ç½‘ç»œç®¡ç†ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½ã€‚

ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼š
1. æœåŠ¡å‘ç° (Service Discovery): è‡ªåŠ¨å‘ç°ç½‘ç»œä¸­çš„æ™ºèƒ½ä½“æœåŠ¡
2. ç½‘ç»œç®¡ç† (Network Management): ç®¡ç†æ™ºèƒ½ä½“ç½‘ç»œçš„æ‹“æ‰‘å’ŒçŠ¶æ€
3. è´Ÿè½½å‡è¡¡ (Load Balancing): åœ¨å¤šä¸ªæ™ºèƒ½ä½“é—´åˆ†é…è¯·æ±‚
4. æ¶ˆæ¯è·¯ç”± (Message Routing): æ™ºèƒ½ä½“é—´çš„æ¶ˆæ¯ä¼ é€’å’Œè·¯ç”±

ğŸ’¡ è®¾è®¡ç†å¿µï¼š
- å¯æ‰©å±•æ€§ï¼šæ”¯æŒå¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œ
- é«˜å¯ç”¨æ€§ï¼šæä¾›æ•…éšœæ£€æµ‹å’Œæ¢å¤æœºåˆ¶
- åŠ¨æ€æ€§ï¼šæ”¯æŒæ™ºèƒ½ä½“çš„åŠ¨æ€åŠ å…¥å’Œç¦»å¼€
- é€æ˜æ€§ï¼šå¯¹ä¸Šå±‚åº”ç”¨é€æ˜çš„ç½‘ç»œç®¡ç†

ğŸ”§ åœ¨ HelloAgents ä¸­çš„å®ç°ï¼š
HelloAgents æä¾›äº† ANP çš„æ¦‚å¿µæ€§å®ç°ï¼š
- ANPNetwork: ç½‘ç»œç®¡ç†å™¨
- ANPDiscovery: æœåŠ¡å‘ç°ç»„ä»¶
- ServiceInfo: æœåŠ¡ä¿¡æ¯æè¿°
- è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±åŠŸèƒ½
"""

    print(concepts)
    wait_for_user()

def lesson_3_2_service_discovery():
    """è¯¾ç¨‹ 3.2: æœåŠ¡å‘ç°å’Œæ³¨å†Œ"""
    print_lesson("3.2", "æœåŠ¡å‘ç°å’Œæ³¨å†Œ")

    discovery_code = '''
from hello_agents.protocols.anp.implementation import ANPDiscovery, ServiceInfo

# åˆ›å»ºæœåŠ¡å‘ç°ç»„ä»¶
discovery = ANPDiscovery()

# æ³¨å†ŒæœåŠ¡
weather_service = ServiceInfo(
    service_id="weather-service",
    service_type="weather",
    endpoint="http://localhost:8001",
    capabilities=["weather_query", "forecast"],
    metadata={"region": "china", "accuracy": "high"}
)

translation_service = ServiceInfo(
    service_id="translation-service",
    service_type="translation",
    endpoint="http://localhost:8002",
    capabilities=["translate", "detect_language"],
    metadata={"languages": ["zh", "en", "ja"]}
)

# æ³¨å†ŒæœåŠ¡
discovery.register_service(weather_service)
discovery.register_service(translation_service)

# æœåŠ¡å‘ç°
weather_services = discovery.find_services_by_type("weather")
translation_services = discovery.find_services_by_capability("translate")
'''

    print_info("ANP æä¾›äº†å¼ºå¤§çš„æœåŠ¡å‘ç°æœºåˆ¶ï¼š")
    print("\nğŸ’» æœåŠ¡å‘ç°ä»£ç ç¤ºä¾‹ï¼š")
    print("```python")
    print(discovery_code)
    print("```")

    print_demo("æœåŠ¡å‘ç°æ¼”ç¤º")

    # æ¨¡æ‹ŸæœåŠ¡æ³¨å†Œå’Œå‘ç°
    services = [
        ("weather-service", "weather", ["weather_query", "forecast"]),
        ("translation-service", "translation", ["translate", "detect_language"]),
        ("analysis-service", "analysis", ["data_analysis", "report_generation"])
    ]

    print("\nğŸ“‹ æ³¨å†ŒæœåŠ¡ï¼š")
    for service_id, service_type, capabilities in services:
        print(f"âœ… {service_id} ({service_type}): {', '.join(capabilities)}")

    print("\nğŸ” æœåŠ¡å‘ç°æµ‹è¯•ï¼š")
    discovery_tests = [
        ("æŒ‰ç±»å‹æŸ¥æ‰¾", "weather", ["weather-service"]),
        ("æŒ‰èƒ½åŠ›æŸ¥æ‰¾", "translate", ["translation-service"]),
        ("æŒ‰ç±»å‹æŸ¥æ‰¾", "analysis", ["analysis-service"])
    ]

    for test_type, query, results in discovery_tests:
        print(f"\nğŸ”§ {test_type}: {query}")
        time.sleep(0.3)
        print_success(f"æ‰¾åˆ°æœåŠ¡: {', '.join(results)}")

    wait_for_user()

def lesson_3_3_network_monitoring():
    """è¯¾ç¨‹ 3.3: ç½‘ç»œæ‹“æ‰‘å’Œç›‘æ§"""
    print_lesson("3.3", "ç½‘ç»œæ‹“æ‰‘å’Œç›‘æ§")

    monitoring_info = """
ğŸ“Š ç½‘ç»œç›‘æ§åŠŸèƒ½ï¼š

ANP æä¾›äº†å…¨é¢çš„ç½‘ç»œç›‘æ§å’Œç®¡ç†åŠŸèƒ½ï¼š

1ï¸âƒ£ ç½‘ç»œçŠ¶æ€ç›‘æ§
   - æ´»è·ƒæ™ºèƒ½ä½“æ•°é‡
   - æ¶ˆæ¯ä¼ é€’ç»Ÿè®¡
   - ç½‘ç»œå¥åº·çŠ¶æ€
   - æ€§èƒ½æŒ‡æ ‡

2ï¸âƒ£ æ‹“æ‰‘ç®¡ç†
   - æ™ºèƒ½ä½“è¿æ¥å…³ç³»
   - ç½‘ç»œæ‹“æ‰‘å›¾
   - è·¯å¾„ä¼˜åŒ–
   - æ•…éšœæ£€æµ‹

3ï¸âƒ£ æ€§èƒ½ç›‘æ§
   - å“åº”æ—¶é—´ç»Ÿè®¡
   - ååé‡ç›‘æ§
   - é”™è¯¯ç‡ç»Ÿè®¡
   - èµ„æºä½¿ç”¨æƒ…å†µ

4ï¸âƒ£ å¥åº·æ£€æŸ¥
   - æ™ºèƒ½ä½“å­˜æ´»æ£€æµ‹
   - æœåŠ¡å¯ç”¨æ€§æ£€æŸ¥
   - è‡ªåŠ¨æ•…éšœæ¢å¤
   - è´Ÿè½½ç›‘æ§
"""

    print(monitoring_info)

    print_demo("ç½‘ç»œç›‘æ§æ¼”ç¤º")

    # æ¨¡æ‹Ÿç½‘ç»œçŠ¶æ€
    network_stats = {
        "network_id": "production-network",
        "active_agents": 15,
        "total_messages": 1247,
        "health_status": "å¥åº·",
        "average_response_time": "45ms",
        "error_rate": "0.2%"
    }

    print("\nğŸ“Š ç½‘ç»œçŠ¶æ€æŠ¥å‘Šï¼š")
    for key, value in network_stats.items():
        print(f"   {key.replace('_', ' ').title()}: {value}")

    # æ¨¡æ‹Ÿæ™ºèƒ½ä½“çŠ¶æ€
    agent_status = [
        ("weather-agent-01", "åœ¨çº¿", "æ­£å¸¸", "12ms"),
        ("translation-agent-02", "åœ¨çº¿", "æ­£å¸¸", "8ms"),
        ("analysis-agent-03", "ç¦»çº¿", "ç»´æŠ¤ä¸­", "N/A"),
        ("report-agent-04", "åœ¨çº¿", "é«˜è´Ÿè½½", "67ms")
    ]

    print("\nğŸ¤– æ™ºèƒ½ä½“çŠ¶æ€ï¼š")
    for agent, status, health, response_time in agent_status:
        status_icon = "ğŸŸ¢" if status == "åœ¨çº¿" else "ğŸ”´"
        print(f"   {status_icon} {agent}: {status} | {health} | {response_time}")

    wait_for_user()

def lesson_3_4_load_balancing():
    """è¯¾ç¨‹ 3.4: è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±"""
    print_lesson("3.4", "è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±")

    balancing_info = """
âš–ï¸ è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š

ANP æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼š

1ï¸âƒ£ è½®è¯¢ (Round Robin)
   - æŒ‰é¡ºåºåˆ†é…è¯·æ±‚
   - é€‚ç”¨äºå¤„ç†èƒ½åŠ›ç›¸åŒçš„æ™ºèƒ½ä½“

2ï¸âƒ£ åŠ æƒè½®è¯¢ (Weighted Round Robin)
   - æ ¹æ®æ™ºèƒ½ä½“èƒ½åŠ›åˆ†é…æƒé‡
   - é€‚ç”¨äºå¤„ç†èƒ½åŠ›ä¸åŒçš„æ™ºèƒ½ä½“

3ï¸âƒ£ æœ€å°‘è¿æ¥ (Least Connections)
   - é€‰æ‹©å½“å‰è¿æ¥æ•°æœ€å°‘çš„æ™ºèƒ½ä½“
   - é€‚ç”¨äºé•¿è¿æ¥åœºæ™¯

4ï¸âƒ£ å“åº”æ—¶é—´ (Response Time)
   - é€‰æ‹©å“åº”æ—¶é—´æœ€çŸ­çš„æ™ºèƒ½ä½“
   - é€‚ç”¨äºå¯¹å»¶è¿Ÿæ•æ„Ÿçš„åº”ç”¨

ğŸ”€ æ¶ˆæ¯è·¯ç”±ï¼š
- ç‚¹å¯¹ç‚¹è·¯ç”±ï¼šç›´æ¥å‘é€åˆ°ç›®æ ‡æ™ºèƒ½ä½“
- å¹¿æ’­è·¯ç”±ï¼šå‘é€åˆ°æ‰€æœ‰ç›¸å…³æ™ºèƒ½ä½“
- ç»„æ’­è·¯ç”±ï¼šå‘é€åˆ°ç‰¹å®šç»„çš„æ™ºèƒ½ä½“
- æ™ºèƒ½è·¯ç”±ï¼šæ ¹æ®å†…å®¹é€‰æ‹©æœ€ä½³è·¯å¾„
"""

    print(balancing_info)

    print_demo("è´Ÿè½½å‡è¡¡æ¼”ç¤º")

    # æ¨¡æ‹Ÿè´Ÿè½½å‡è¡¡
    agents = [
        ("agent-01", 3, "12ms"),
        ("agent-02", 1, "8ms"),
        ("agent-03", 5, "15ms"),
        ("agent-04", 2, "10ms")
    ]

    print("\nâš–ï¸ æ™ºèƒ½ä½“è´Ÿè½½çŠ¶æ€ï¼š")
    for agent, load, response_time in agents:
        load_bar = "â–ˆ" * load + "â–‘" * (5 - load)
        print(f"   {agent}: [{load_bar}] {load}/5 | {response_time}")

    print("\nğŸ”€ è´Ÿè½½å‡è¡¡å†³ç­–ï¼š")
    balancing_decisions = [
        ("è¯·æ±‚ 1", "é€‰æ‹© agent-02ï¼ˆè´Ÿè½½æœ€ä½ï¼‰"),
        ("è¯·æ±‚ 2", "é€‰æ‹© agent-04ï¼ˆå“åº”æ—¶é—´ä¼˜ï¼‰"),
        ("è¯·æ±‚ 3", "é€‰æ‹© agent-01ï¼ˆè½®è¯¢ç­–ç•¥ï¼‰"),
        ("è¯·æ±‚ 4", "é€‰æ‹© agent-02ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰")
    ]

    for request, decision in balancing_decisions:
        print(f"   {request}: {decision}")
        time.sleep(0.4)

    wait_for_user()

def lesson_3_5_large_scale_management():
    """è¯¾ç¨‹ 3.5: å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œç®¡ç†"""
    print_lesson("3.5", "å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œç®¡ç†")

    scale_info = """
ğŸ—ï¸ å¤§è§„æ¨¡ç½‘ç»œç®¡ç†æŒ‘æˆ˜ï¼š

å½“æ™ºèƒ½ä½“ç½‘ç»œè§„æ¨¡æ‰©å¤§æ—¶ï¼Œé¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ï¼š

1ï¸âƒ£ å¯æ‰©å±•æ€§æŒ‘æˆ˜
   - æœåŠ¡å‘ç°çš„æ€§èƒ½ç“¶é¢ˆ
   - ç½‘ç»œæ‹“æ‰‘çš„å¤æ‚æ€§
   - æ¶ˆæ¯è·¯ç”±çš„æ•ˆç‡
   - çŠ¶æ€åŒæ­¥çš„å¼€é”€

2ï¸âƒ£ è§£å†³æ–¹æ¡ˆ
   - åˆ†å±‚ç½‘ç»œæ¶æ„
   - åˆ†å¸ƒå¼æœåŠ¡å‘ç°
   - æ™ºèƒ½è·¯ç”±ç®—æ³•
   - ç¼“å­˜å’Œé¢„å–æœºåˆ¶

3ï¸âƒ£ æœ€ä½³å®è·µ
   - ç½‘ç»œåˆ†åŒºç®¡ç†
   - å°±è¿‘æœåŠ¡é€‰æ‹©
   - å¼‚æ­¥æ¶ˆæ¯å¤„ç†
   - æ•…éšœéš”ç¦»æœºåˆ¶

4ï¸âƒ£ ç›‘æ§å’Œè¿ç»´
   - å®æ—¶æ€§èƒ½ç›‘æ§
   - è‡ªåŠ¨æ‰©ç¼©å®¹
   - æ•…éšœè‡ªåŠ¨æ¢å¤
   - å®¹é‡è§„åˆ’
"""

    print(scale_info)

    print_demo("å¤§è§„æ¨¡ç½‘ç»œç®¡ç†æ¼”ç¤º")

    # æ¨¡æ‹Ÿå¤§è§„æ¨¡ç½‘ç»œ
    network_regions = [
        ("ååŒ—åŒº", 45, "æ­£å¸¸"),
        ("åä¸œåŒº", 67, "æ­£å¸¸"),
        ("åå—åŒº", 38, "é«˜è´Ÿè½½"),
        ("è¥¿å—åŒº", 23, "æ­£å¸¸"),
        ("æµ·å¤–åŒº", 15, "ç½‘ç»œå»¶è¿Ÿ")
    ]

    print("\nğŸŒ ç½‘ç»œåŒºåŸŸçŠ¶æ€ï¼š")
    total_agents = 0
    for region, agents, status in network_regions:
        status_icon = "ğŸŸ¢" if status == "æ­£å¸¸" else "ğŸŸ¡" if "é«˜è´Ÿè½½" in status else "ğŸ”´"
        print(f"   {status_icon} {region}: {agents} ä¸ªæ™ºèƒ½ä½“ | {status}")
        total_agents += agents

    print(f"\nğŸ“Š ç½‘ç»œæ€»è§ˆï¼š")
    print(f"   æ€»æ™ºèƒ½ä½“æ•°: {total_agents}")
    print(f"   æ´»è·ƒåŒºåŸŸ: 5")
    print(f"   æ€»ä½“å¥åº·åº¦: 85%")

    wait_for_user()

# ============================================================================
# ç¬¬å››éƒ¨åˆ†ï¼šåè®®å¯¹æ¯”å’Œé€‰æ‹©
# ============================================================================

def lesson_4_1_protocol_comparison():
    """è¯¾ç¨‹ 4.1: ä¸‰ç§åè®®ç‰¹æ€§å¯¹æ¯”"""
    print_lesson("4.1", "ä¸‰ç§åè®®ç‰¹æ€§å¯¹æ¯”")

    comparison_table = """
ğŸ“Š åè®®ç‰¹æ€§å¯¹æ¯”è¡¨ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ç‰¹æ€§     â”‚       MCP        â”‚       A2A        â”‚       ANP        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»è¦ç”¨é€”   â”‚ å·¥å…·è°ƒç”¨ã€èµ„æºè®¿é—® â”‚ æ™ºèƒ½ä½“é—´é€šä¿¡åä½œ  â”‚ ç½‘ç»œç®¡ç†ã€æœåŠ¡å‘ç° â”‚
â”‚  é€šä¿¡æ¨¡å¼   â”‚ å®¢æˆ·ç«¯-æœåŠ¡å™¨     â”‚ ç‚¹å¯¹ç‚¹ã€å¤šå¯¹å¤š    â”‚ ç½‘ç»œæ‹“æ‰‘ç®¡ç†      â”‚
â”‚  é€‚ç”¨è§„æ¨¡   â”‚ å•ä¸€å·¥å…·é›†æˆ      â”‚ å°åˆ°ä¸­å‹å›¢é˜Ÿåä½œ  â”‚ å¤§è§„æ¨¡åˆ†å¸ƒå¼ç½‘ç»œ  â”‚
â”‚  å®ç°å¤æ‚åº¦ â”‚ ç®€å•             â”‚ ä¸­ç­‰             â”‚ å¤æ‚             â”‚
â”‚  æ ‡å‡†åŒ–ç¨‹åº¦ â”‚ é«˜ï¼ˆå®˜æ–¹åè®®ï¼‰    â”‚ ä¸­ç­‰ï¼ˆç¤¾åŒºæ ‡å‡†ï¼‰  â”‚ ä½ï¼ˆæ¦‚å¿µæ€§å®ç°ï¼‰  â”‚
â”‚  å­¦ä¹ éš¾åº¦   â”‚ å®¹æ˜“             â”‚ ä¸­ç­‰             â”‚ å›°éš¾             â”‚
â”‚  å¼€å‘æ•ˆç‡   â”‚ é«˜               â”‚ ä¸­ç­‰             â”‚ ä½               â”‚
â”‚  è¿ç»´å¤æ‚åº¦ â”‚ ä½               â”‚ ä¸­ç­‰             â”‚ é«˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ¯ é€‰æ‹©å»ºè®®ï¼š

é€‰æ‹© MCP å½“ä½ éœ€è¦ï¼š
âœ… é›†æˆå¤–éƒ¨å·¥å…·å’ŒæœåŠ¡
âœ… è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰èµ„æº
âœ… ä½¿ç”¨æ ‡å‡†åŒ–çš„å·¥å…·è°ƒç”¨æ¥å£
âœ… å¿«é€Ÿå¼€å‘å’Œéƒ¨ç½²

é€‰æ‹© A2A å½“ä½ éœ€è¦ï¼š
âœ… å¤šä¸ªæ™ºèƒ½ä½“åä½œå®Œæˆå¤æ‚ä»»åŠ¡
âœ… å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–
âœ… æ™ºèƒ½ä½“é—´æŠ€èƒ½å…±äº«å’Œç»„åˆ
âœ… ä¸­ç­‰è§„æ¨¡çš„åä½œç³»ç»Ÿ

é€‰æ‹© ANP å½“ä½ éœ€è¦ï¼š
âœ… ç®¡ç†å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œ
âœ… å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡
âœ… æ„å»ºåˆ†å¸ƒå¼æ™ºèƒ½ä½“ç³»ç»Ÿ
âœ… ä¼ä¸šçº§æ™ºèƒ½ä½“å¹³å°
"""

    print(comparison_table)
    wait_for_user()

def lesson_4_2_scenario_selection():
    """è¯¾ç¨‹ 4.2: åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—"""
    print_lesson("4.2", "åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—")

    scenarios = """
ğŸ¯ åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—ï¼š

1ï¸âƒ£ ä¸ªäººåŠ©æ‰‹åº”ç”¨
   æ¨èåè®®: MCP
   ç†ç”±: ä¸»è¦éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼ˆæ—¥å†ã€é‚®ä»¶ã€æ–‡ä»¶ç­‰ï¼‰
   ç¤ºä¾‹: æ™ºèƒ½æ–‡æ¡£åŠ©æ‰‹ã€ä»£ç åˆ†æå·¥å…·

2ï¸âƒ£ å›¢é˜Ÿåä½œç³»ç»Ÿ
   æ¨èåè®®: A2A
   ç†ç”±: éœ€è¦å¤šä¸ªä¸“ä¸šæ™ºèƒ½ä½“åä½œå®Œæˆä»»åŠ¡
   ç¤ºä¾‹: å†…å®¹åˆ›ä½œå›¢é˜Ÿã€ä»£ç å®¡æŸ¥ç³»ç»Ÿ

3ï¸âƒ£ ä¼ä¸šçº§æ™ºèƒ½ä½“å¹³å°
   æ¨èåè®®: ANP + MCP + A2A
   ç†ç”±: éœ€è¦å…¨é¢çš„ç½‘ç»œç®¡ç†å’Œå¤šç§é€šä¿¡æ–¹å¼
   ç¤ºä¾‹: æ™ºæ…§åŸå¸‚ç®¡ç†ã€å¤§å‹å®¢æœç³»ç»Ÿ

4ï¸âƒ£ ç‰©è”ç½‘æ™ºèƒ½ä½“ç½‘ç»œ
   æ¨èåè®®: ANP
   ç†ç”±: éœ€è¦ç®¡ç†å¤§é‡åˆ†å¸ƒå¼æ™ºèƒ½ä½“è®¾å¤‡
   ç¤ºä¾‹: æ™ºèƒ½å®¶å±…ç½‘ç»œã€å·¥ä¸šç‰©è”ç½‘

5ï¸âƒ£ æ•™è‚²æ™ºèƒ½ä½“ç³»ç»Ÿ
   æ¨èåè®®: A2A + MCP
   ç†ç”±: éœ€è¦æ™ºèƒ½ä½“åä½œå’Œå·¥å…·è°ƒç”¨
   ç¤ºä¾‹: ä¸ªæ€§åŒ–å­¦ä¹ ç³»ç»Ÿã€æ™ºèƒ½è¾…å¯¼å¹³å°

ğŸ’¡ é€‰æ‹©åŸåˆ™ï¼š
- ç®€å•ä¼˜å…ˆï¼šèƒ½ç”¨ç®€å•åè®®è§£å†³çš„ä¸ç”¨å¤æ‚åè®®
- éœ€æ±‚å¯¼å‘ï¼šæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„åè®®
- æ¸è¿›å¼ï¼šä»ç®€å•åè®®å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚æ€§
- ç»„åˆä½¿ç”¨ï¼šä¸åŒåè®®å¯ä»¥ç»„åˆä½¿ç”¨
"""

    print(scenarios)
    wait_for_user()

def lesson_4_3_combination_strategies():
    """è¯¾ç¨‹ 4.3: åè®®ç»„åˆä½¿ç”¨ç­–ç•¥"""
    print_lesson("4.3", "åè®®ç»„åˆä½¿ç”¨ç­–ç•¥")

    combination_code = '''
# å¤šåè®®é›†æˆç¤ºä¾‹
from hello_agents import SimpleAgent, HelloAgentsLLM
from hello_agents.tools.builtin.protocol_tools import MCPTool, A2ATool

# åˆ›å»ºæ™ºèƒ½ä½“
agent = SimpleAgent(name="å¤šåè®®åŠ©æ‰‹", llm=HelloAgentsLLM())

# æ·»åŠ  MCP å·¥å…·ï¼ˆå¤–éƒ¨æœåŠ¡è®¿é—®ï¼‰
weather_tool = MCPTool(
    server_command=["python", "weather_server.py"],
    name="å¤©æ°”æŸ¥è¯¢å·¥å…·"
)
agent.add_tool(weather_tool)

file_tool = MCPTool(
    server_command=["npx", "@modelcontextprotocol/server-filesystem", "."],
    name="æ–‡ä»¶ç³»ç»Ÿå·¥å…·"
)
agent.add_tool(file_tool)

# æ·»åŠ  A2A å·¥å…·ï¼ˆæ™ºèƒ½ä½“åä½œï¼‰
research_agent = A2ATool(
    agent_endpoint="http://localhost:8001",
    name="ç ”ç©¶æ™ºèƒ½ä½“"
)
agent.add_tool(research_agent)

analysis_agent = A2ATool(
    agent_endpoint="http://localhost:8002",
    name="åˆ†ææ™ºèƒ½ä½“"
)
agent.add_tool(analysis_agent)

# ANP åœ¨åå°ç®¡ç†ç½‘ç»œï¼ˆé€æ˜ï¼‰
# æ™ºèƒ½ä½“å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šç§åè®®
response = agent.run("""
è¯·å¸®æˆ‘å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
1. æŸ¥è¯¢åŒ—äº¬çš„å¤©æ°”æƒ…å†µ
2. å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶
3. ä¸ç ”ç©¶æ™ºèƒ½ä½“åä½œåˆ†æå¤©æ°”è¶‹åŠ¿
4. ç”Ÿæˆç»¼åˆæŠ¥å‘Š
""")
'''

    print_info("åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç»„åˆä½¿ç”¨å¤šç§åè®®ï¼š")
    print("\nğŸ’» å¤šåè®®é›†æˆä»£ç ç¤ºä¾‹ï¼š")
    print("```python")
    print(combination_code)
    print("```")

    print_demo("å¤šåè®®åä½œæ¼”ç¤º")

    # æ¨¡æ‹Ÿå¤šåè®®åä½œæµç¨‹
    collaboration_steps = [
        ("MCP", "æŸ¥è¯¢å¤©æ°”ä¿¡æ¯", "è·å–åŒ—äº¬å¤©æ°”ï¼šæ™´æœ—ï¼Œ15Â°C"),
        ("MCP", "ä¿å­˜åˆ°æ–‡ä»¶", "æˆåŠŸä¿å­˜åˆ° weather_data.json"),
        ("A2A", "è¯·æ±‚ç ”ç©¶æ™ºèƒ½ä½“åˆ†æ", "åˆ†æå®Œæˆï¼šæ¸©åº¦è¶‹åŠ¿ä¸Šå‡"),
        ("A2A", "è¯·æ±‚åˆ†ææ™ºèƒ½ä½“å¤„ç†", "ç”Ÿæˆè¶‹åŠ¿å›¾è¡¨"),
        ("ANP", "è´Ÿè½½å‡è¡¡é€‰æ‹©æœåŠ¡", "é€‰æ‹©æœ€ä¼˜çš„æŠ¥å‘Šç”ŸæˆæœåŠ¡"),
        ("é›†æˆ", "ç”Ÿæˆç»¼åˆæŠ¥å‘Š", "å®Œæˆå¤šåè®®åä½œä»»åŠ¡")
    ]

    for protocol, action, result in collaboration_steps:
        print(f"\nğŸ”§ [{protocol}] {action}")
        time.sleep(0.6)
        print_success(result)

    wait_for_user()

def lesson_4_4_best_practices():
    """è¯¾ç¨‹ 4.4: æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹"""
    print_lesson("4.4", "æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹")

    best_practices = """
ğŸ† æœ€ä½³å®è·µæŒ‡å—ï¼š

1ï¸âƒ£ è®¾è®¡åŸåˆ™
   âœ… å•ä¸€èŒè´£ï¼šæ¯ä¸ªåè®®ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½
   âœ… æ¾è€¦åˆï¼šåè®®é—´ä¿æŒç‹¬ç«‹ï¼Œå‡å°‘ä¾èµ–
   âœ… å¯æ‰©å±•ï¼šè®¾è®¡æ—¶è€ƒè™‘æœªæ¥çš„æ‰©å±•éœ€æ±‚
   âœ… å®¹é”™æ€§ï¼šå®ç°ä¼˜é›…çš„é”™è¯¯å¤„ç†å’Œæ¢å¤

2ï¸âƒ£ å¼€å‘å»ºè®®
   âœ… æ¸è¿›å¼å¼€å‘ï¼šä»ç®€å•åè®®å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚æ€§
   âœ… å……åˆ†æµ‹è¯•ï¼šæ¯ä¸ªåè®®éƒ½è¦æœ‰å®Œæ•´çš„æµ‹è¯•è¦†ç›–
   âœ… æ–‡æ¡£å®Œå–„ï¼šæä¾›æ¸…æ™°çš„APIæ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹
   âœ… ç‰ˆæœ¬ç®¡ç†ï¼šåè®®å‡çº§æ—¶ä¿æŒå‘åå…¼å®¹

3ï¸âƒ£ è¿ç»´è¦ç‚¹
   âœ… ç›‘æ§å‘Šè­¦ï¼šå®æ—¶ç›‘æ§åè®®çš„è¿è¡ŒçŠ¶æ€
   âœ… æ€§èƒ½ä¼˜åŒ–ï¼šå®šæœŸåˆ†æå’Œä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ
   âœ… å®‰å…¨é˜²æŠ¤ï¼šå®ç°é€‚å½“çš„è®¤è¯å’Œæˆæƒæœºåˆ¶
   âœ… å¤‡ä»½æ¢å¤ï¼šåˆ¶å®šå®Œå–„çš„å¤‡ä»½å’Œæ¢å¤ç­–ç•¥

4ï¸âƒ£ å¸¸è§é™·é˜±
   âŒ è¿‡åº¦è®¾è®¡ï¼šä¸è¦ä¸ºäº†ä½¿ç”¨åè®®è€Œä½¿ç”¨åè®®
   âŒ åè®®æ··ç”¨ï¼šé¿å…åœ¨åŒä¸€å±‚æ¬¡æ··ç”¨å¤šç§åè®®
   âŒ å¿½ç•¥æ€§èƒ½ï¼šåè®®é€šä¿¡çš„æ€§èƒ½å¼€é”€ä¸å¯å¿½è§†
   âŒ ç¼ºä¹ç›‘æ§ï¼šæ²¡æœ‰ç›‘æ§å°±æ— æ³•å‘ç°å’Œè§£å†³é—®é¢˜

ğŸ’¡ æˆåŠŸè¦ç´ ï¼š
- æ˜ç¡®éœ€æ±‚ï¼šæ¸…æ¥šäº†è§£è¦è§£å†³çš„é—®é¢˜
- åˆç†é€‰æ‹©ï¼šé€‰æ‹©æœ€é€‚åˆçš„åè®®ç»„åˆ
- å……åˆ†æµ‹è¯•ï¼šç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§
- æŒç»­ä¼˜åŒ–ï¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µä¸æ–­æ”¹è¿›
"""

    print(best_practices)
    wait_for_user()

# ============================================================================
# ä¸»ç¨‹åºå’Œèœå•ç³»ç»Ÿ
# ============================================================================

def show_main_menu():
    """æ˜¾ç¤ºä¸»èœå•"""
    menu = """
ğŸ“ ç¬¬åç« ï¼šæ™ºèƒ½ä½“é€šä¿¡åè®® - å­¦ä¹ èœå•

è¯·é€‰æ‹©è¦å­¦ä¹ çš„å†…å®¹ï¼š

ç¬¬ä¸€éƒ¨åˆ†ï¼šMCP (Model Context Protocol)
  1.1 - MCP åŸºç¡€æ¦‚å¿µå’Œè®¾è®¡ç†å¿µ
  1.2 - ä½¿ç”¨å®˜æ–¹ MCP æœåŠ¡å™¨å®æˆ˜
  1.3 - åˆ›å»ºè‡ªå®šä¹‰ MCP æœåŠ¡å™¨
  1.4 - å¤šç§ä¼ è¾“æ–¹å¼è¯¦è§£
  1.5 - åœ¨ HelloAgents ä¸­é›†æˆ MCP

ç¬¬äºŒéƒ¨åˆ†ï¼šA2A (Agent-to-Agent Protocol)
  2.1 - A2A åè®®æ ¸å¿ƒæ¦‚å¿µ
  2.2 - åŸºäºå®˜æ–¹ SDK åˆ›å»ºæ™ºèƒ½ä½“
  2.3 - å¤šæ™ºèƒ½ä½“åä½œå·¥ä½œæµ
  2.4 - æ™ºèƒ½ä½“æŠ€èƒ½å…±äº«æœºåˆ¶
  2.5 - å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨

ç¬¬ä¸‰éƒ¨åˆ†ï¼šANP (Agent Network Protocol)
  3.1 - ANP ç½‘ç»œç®¡ç†æ¦‚å¿µ
  3.2 - æœåŠ¡å‘ç°å’Œæ³¨å†Œ
  3.3 - ç½‘ç»œæ‹“æ‰‘å’Œç›‘æ§
  3.4 - è´Ÿè½½å‡è¡¡å’Œæ¶ˆæ¯è·¯ç”±
  3.5 - å¤§è§„æ¨¡æ™ºèƒ½ä½“ç½‘ç»œç®¡ç†

ç¬¬å››éƒ¨åˆ†ï¼šåè®®å¯¹æ¯”å’Œé€‰æ‹©
  4.1 - ä¸‰ç§åè®®ç‰¹æ€§å¯¹æ¯”
  4.2 - åº”ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—
  4.3 - åè®®ç»„åˆä½¿ç”¨ç­–ç•¥
  4.4 - æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹

ç‰¹æ®Šé€‰é¡¹ï¼š
  0   - è¯¾ç¨‹æ¦‚è§ˆ
  all - å®Œæ•´å­¦ä¹ ï¼ˆæŒ‰é¡ºåºå­¦ä¹ æ‰€æœ‰å†…å®¹ï¼‰
  q   - é€€å‡ºç¨‹åº

è¯·è¾“å…¥é€‰é¡¹ï¼ˆå¦‚ 1.1, 2.3, all ç­‰ï¼‰ï¼š"""

    return menu

def main():
    """ä¸»ç¨‹åº"""
    print_header("æ¬¢è¿å­¦ä¹ ç¬¬åç« ï¼šæ™ºèƒ½ä½“é€šä¿¡åè®®")

    # æ£€æŸ¥ä¾èµ–
    check_dependencies()

    # è¯¾ç¨‹æ˜ å°„
    lessons = {
        "0": show_course_overview,
        "1.1": lesson_1_1_mcp_concepts,
        "1.2": lesson_1_2_official_mcp_servers,
        "1.3": lesson_1_3_custom_mcp_server,
        "1.4": lesson_1_4_transport_methods,
        "1.5": lesson_1_5_mcp_in_helloagents,
        "2.1": lesson_2_1_a2a_concepts,
        "2.2": lesson_2_2_create_a2a_agents,
        "2.3": lesson_2_3_multi_agent_collaboration,
        "2.4": lesson_2_4_skill_sharing,
        "2.5": lesson_2_5_business_scenarios,
        "3.1": lesson_3_1_anp_concepts,
        "3.2": lesson_3_2_service_discovery,
        "3.3": lesson_3_3_network_monitoring,
        "3.4": lesson_3_4_load_balancing,
        "3.5": lesson_3_5_large_scale_management,
        "4.1": lesson_4_1_protocol_comparison,
        "4.2": lesson_4_2_scenario_selection,
        "4.3": lesson_4_3_combination_strategies,
        "4.4": lesson_4_4_best_practices
    }

    while True:
        print(show_main_menu())
        choice = input().strip().lower()

        if choice == 'q':
            print("\nğŸ‘‹ æ„Ÿè°¢å­¦ä¹ ç¬¬åç« ï¼šæ™ºèƒ½ä½“é€šä¿¡åè®®ï¼")
            print("ğŸ‰ å¸Œæœ›è¿™äº›çŸ¥è¯†å¯¹ä½ çš„é¡¹ç›®æœ‰æ‰€å¸®åŠ©ã€‚")
            break
        elif choice == 'all':
            print_info("å¼€å§‹å®Œæ•´å­¦ä¹ æ¨¡å¼...")
            # æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰è¯¾ç¨‹
            lesson_order = [
                "0", "1.1", "1.2", "1.3", "1.4", "1.5",
                "2.1", "2.2", "2.3", "2.4", "2.5",
                "3.1", "3.2", "3.3", "3.4", "3.5",
                "4.1", "4.2", "4.3", "4.4"
            ]
            for lesson_id in lesson_order:
                if lesson_id in lessons:
                    lessons[lesson_id]()
            print_success("ğŸ“ æ­å–œï¼ä½ å·²å®Œæˆç¬¬åç« çš„å…¨éƒ¨å­¦ä¹ å†…å®¹ï¼")
        elif choice in lessons:
            lessons[choice]()
        else:
            print_error("æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡æ–°é€‰æ‹©ã€‚")

if __name__ == "__main__":
    main()